!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const o={width:500,height:500};var i={MAX_DIMENSIONS:o,areCorrectDimensions:function(e){return e.width>0&&e.width<=o.width&&e.height>0&&e.height<=o.height}};const r=document.getElementById("video-container");var a={createVideo:function(){const e=document.createElement("video");return e.setAttribute("autoplay","true"),e.setAttribute("width",o.width),e.setAttribute("height",o.height),e.setAttribute("role","application"),e.setAttribute("aria-label","Camera"),e.classList.add("video"),e},addVideoToView:function(e){r.appendChild(e)},loadStreamInVideo:function(e,t){try{t.srcObject=e}catch(n){t.src=URL.createObjectURL(e)}return new Promise(e=>t.addEventListener("loadeddata",t=>e(t.target),{once:!0}))},getWithHeightRatio:function(e){if(e.videoHeight>0&&e.videoHeight>0)return e.videoWidth/e.videoHeight;throw new Error(`Invalid dimensions {videoWidth: ${e.videoWidth}, videoHeight: ${e.videoHeight}}. They must be numbers greater than 0`)}};const d=document.getElementById("result-list");var c={createCanvasFromDataUrl:function(e,t){if(!i.areCorrectDimensions(t))throw new Error(`Invalid dimensions {width: ${t.width} height: ${t.height}}`);const n=new Image(t.width,t.height);n.src=e;const o=document.createElement("canvas");o.width=t.width,o.height=t.height;const r=o.getContext("2d");return new Promise(e=>n.onload=(()=>{r.drawImage(n,0,0,t.width,t.height),e(o)}))},addCanvasToView:function(e){const t=d.children.length+1;e.setAttribute("role","img"),e.setAttribute("aria-label",`Photo ${t} after applying the filter`);const n=document.createElement("li");n.classList.add("result-container");const o=function(e,{downloadedFileName:t="download",linkName:n="download"}={}){const o=document.createElement("a");return o.setAttribute("download",t),o.setAttribute("href",e),o.classList.add("download-image-link"),o.innerText=n,o}(e.toDataURL(),{downloadedFileName:`photo_${t}`,linkName:`Download Photo ${t}`});n.appendChild(e),n.appendChild(o),d.appendChild(n)}};document.addEventListener("DOMContentLoaded",()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("service_worker.js").then(console.log).catch(console.error);const e=a.createVideo();a.addVideoToView(e);const t=document.getElementById("take-photo-button"),n=ml5.styleTransfer("models/scream");navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(t=>a.loadStreamInVideo(t,e)).then(e=>{const i=a.getWithHeightRatio(e),r={...o};r.height/=i,t.addEventListener("click",()=>n.then(t=>t.transfer(e)).then(e=>c.createCanvasFromDataUrl(e.src,r)).then(e=>c.addCanvasToView(e)))}).catch(e=>console.error("ERROR: ",e))})}]);